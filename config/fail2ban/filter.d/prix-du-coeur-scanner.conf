# ============================================
# FILTRE: Scanners de vulnérabilités
# ============================================
# Détecte les outils de scan automatique:
# - Nikto, Nmap, SQLMap, Burp Suite
# - Bots de scan WordPress, phpMyAdmin
# - Accès à des fichiers sensibles

[Definition]

# Regex pour détecter les scanners
failregex = ^<HOST> .* "(GET|POST|HEAD) .*(\\.php|\\.asp|\\.aspx|\\.jsp|\\.cgi|\\.pl)[^"]*" (404|403|500) .*$
            ^<HOST> .* "(GET|POST) .*(wp-admin|wp-login|wp-content|wordpress|phpmyadmin|adminer|phpinfo)[^"]*" .*$
            ^<HOST> .* "(GET|POST) .*(\\.git|\\.env|\\.svn|\\.htaccess|\\.htpasswd|config\\.php|web\\.config)[^"]*" .*$
            ^<HOST> .* "(GET|POST) .*(/admin|/administrator|/manager|/cpanel|/webmail)[^"]*" (404|403) .*$
            ^<HOST> .* "(GET|POST) .*(shell|c99|r57|webshell|backdoor)[^"]*" .*$
            ^<HOST> .* ".*" 400 .* "-" "(python-requests|curl|wget|nikto|nmap|sqlmap|masscan|zgrab)".*$

ignoreregex = ^<HOST> .* "GET /adminer\\.php.*" 200 .*$

# Note: On ignore adminer.php avec 200 (accès légitime)
